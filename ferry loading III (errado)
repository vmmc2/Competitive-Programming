#include <bits/stdc++.h>

using namespace std;

int main(){
    int numcasos;
    queue <int> left;
    queue <int> right;
    int capacidade, minutes, numcarros;
    char lado[10];
    int resposta;
    int aux;
    int carro1;
    int flag;
    scanf("%d", &numcasos);
    for(int i = 1; i <= numcasos; i++){
        resposta = 0;
        scanf("%d %d %d", &capacidade, &minutes, &numcarros);
        for(int j = 1; j <= numcarros; j++){
            scanf("%d %s", &aux, lado);
            if(lado[0] == 'l'){
                left.push(aux);
            }
            else{
                right.push(aux);
            }
        }
        for(int j = 0; ; j++){
            resposta += minutes;
            if(left.empty() && right.empty()){
                break;
            }
            flag = 1;
            if(j % 2 == 0){//saindo de left para right
                while(!left.empty() && flag <= capacidade){
                    carro1 = left.front();
                    printf("%d\n", carro1+resposta);
                    left.pop();
                    flag++;
                }
            }
            else if(j % 2 != 0){//saindo de right para left
                while(!right.empty() && flag <= capacidade){
                    carro1 = right.front();
                    printf("%d\n", carro1+resposta);
                    right.pop();
                    flag++;
                }
            }
        }
        while(!left.empty()){
            left.pop();
        }
        while(!right.empty()){
            right.pop();
        }
        if(i < numcasos){
            printf("\n");
        }
    }
    return 0;
}
